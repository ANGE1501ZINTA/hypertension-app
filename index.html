<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Hypertension Risk Predictor</title>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
    font-family: 'Montserrat', sans-serif;
    background: linear-gradient(135deg, #e3f2fd, #bbdefb);
    min-height: 100vh;
    margin: 0;
    padding: 30px;
}

h1 {
    text-align: center;
    font-weight: 700;
    color: #0d47a1;
    letter-spacing: 1px;
}

.subtitle {
    text-align: center;
    color: #1565c0;
    margin-bottom: 30px;
}

.container {
    max-width: 1200px;
    margin: auto;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
}

.card {
    background: white;
    padding: 25px;
    border-radius: 20px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.15);
}

.card h3 {
    color: #0d47a1;
    margin-bottom: 15px;
}

input, select, button {
    width: 100%;
    margin-top: 10px;
    padding: 12px;
    border-radius: 10px;
    border: 1px solid #ccc;
    font-size: 14px;
}

button {
    background: #0d47a1;
    color: white;
    border: none;
    cursor: pointer;
    font-weight: 600;
    margin-top: 20px;
}

button:disabled {
    opacity: 0.6;
}

.result {
    display: none;
}

.risk-low {
    color: #2e7d32;
    font-weight: 600;
}

.risk-high {
    color: #c62828;
    font-weight: 600;
}

.advice {
    margin-top: 15px;
    padding: 15px;
    border-radius: 12px;
}

.advice.low {
    background: #e8f5e9;
    border-left: 6px solid #2e7d32;
}

.advice.high {
    background: #ffebee;
    border-left: 6px solid #c62828;
}

.avatar {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
}

.avatar img {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    object-fit: cover;
}
</style>
</head>

<body>

<h1>ðŸ«€ Hypertension Risk Predictor</h1>
<p class="subtitle">AI-powered medical decision support</p>

<div class="container">

<!-- FORM -->
<div class="card">
<h3>Patient Information</h3>

<input id="age" type="number" placeholder="Age">
<select id="gender">
    <option value="0">Female</option>
    <option value="1">Male</option>
</select>
<input id="height" type="number" placeholder="Height (cm)">
<input id="weight" type="number" placeholder="Weight (kg)">
<input id="ap_hi" type="number" placeholder="Systolic Pressure">
<input id="ap_lo" type="number" placeholder="Diastolic Pressure">

<select id="cholesterol">
    <option value="1">Cholesterol Normal</option>
    <option value="2">Above normal</option>
    <option value="3">High</option>
</select>

<select id="gluc">
    <option value="1">Glucose Normal</option>
    <option value="2">Above normal</option>
    <option value="3">High</option>
</select>

<select id="smoke">
    <option value="0">Non-smoker</option>
    <option value="1">Smoker</option>
</select>

<select id="alco">
    <option value="0">No alcohol</option>
    <option value="1">Alcohol</option>
</select>

<select id="active">
    <option value="0">Inactive</option>
    <option value="1">Active</option>
</select>

<button id="btn" onclick="predict()">Analyze Risk</button>
</div>

<!-- RESULTS -->
<div class="card">
<h3>Medical Analysis</h3>

<div class="result" id="result">

<div class="avatar">
<img src="https://i.imgur.com/8Km9tLL.png" alt="Doctor Avatar">
<div>
<strong>Virtual Doctor</strong><br>
<span id="diagnostic"></span>
</div>
</div>

<p><strong>Risk:</strong> <span id="prob"></span>%</p>
<p><strong>BMI:</strong> <span id="bmi"></span></p>

<div id="adviceBox" class="advice"></div>

<canvas id="riskChart"></canvas>
</div>
</div>

</div>

<script>
let chart;
const API_URL = "https://hypertension-api-3.onrender.com/predict";

async function predict() {
    const btn = document.getElementById("btn");
    btn.disabled = true;
    btn.innerText = "Analyzing...";

    const payload = {
        age:+age.value, gender:+gender.value,
        height:+height.value, weight:+weight.value,
        ap_hi:+ap_hi.value, ap_lo:+ap_lo.value,
        cholesterol:+cholesterol.value, gluc:+gluc.value,
        smoke:+smoke.value, alco:+alco.value, active:+active.value
    };

    try {
        const res = await fetch(API_URL, {
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify(payload)
        });

        if (!res.ok) throw new Error();

        const data = await res.json();
        const risk = data.probability_percent;

        document.getElementById("prob").innerText = risk;
        document.getElementById("bmi").innerText = data.BMI;
        document.getElementById("diagnostic").innerText = data.diagnostic;
        document.getElementById("result").style.display = "block";

        const adviceBox = document.getElementById("adviceBox");

        if (risk >= 50) {
            adviceBox.className = "advice high";
            adviceBox.innerHTML = `
            <strong>Medical Advice:</strong>
            <ul>
                <li>Consult a healthcare professional</li>
                <li>Reduce salt and alcohol intake</li>
                <li>Increase physical activity</li>
                <li>Monitor blood pressure regularly</li>
            </ul>`;
        } else {
            adviceBox.className = "advice low";
            adviceBox.innerHTML = `
            <strong>Medical Advice:</strong>
            <ul>
                <li>Maintain a healthy lifestyle</li>
                <li>Balanced diet & regular exercise</li>
                <li>Routine blood pressure check-ups</li>
            </ul>`;
        }

        if(chart) chart.destroy();
        chart = new Chart(riskChart,{
            type:"doughnut",
            data:{
                labels:["Risk","Safe"],
                datasets:[{ data:[risk, 100-risk] }]
            }
        });

    } catch {
        alert("API is waking up. Please wait 10â€“15 seconds and retry.");
    } finally {
        btn.disabled = false;
        btn.innerText = "Analyze Risk";
    }
}
</script>

</body>
</html>
